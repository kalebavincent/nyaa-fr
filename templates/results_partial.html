<div id="search-results">
    {% if torrents %}
    {% for torrent in torrents %}
    <div class="torrent-card animate-fadeIn">
        <div class="p-3 sm:p-5">
            <!-- Ligne supérieure mobile -->
            <div class="flex justify-between items-start">
                <div class="flex-1 min-w-0 mr-2">
                    <!-- Titre avec retour à la ligne forcé -->
                    <h3 class="text-sm font-bold text-gray-900 dark:text-white break-words hyphens-auto">
                        {{ torrent.title }}
                    </h3>

                    <div class="flex flex-wrap items-center mt-1 gap-x-2 gap-y-1">
                        <span class="inline-block bg-indigo-100 dark:bg-indigo-900 text-indigo-700 dark:text-indigo-300 text-[10px] font-semibold px-2 py-0.5 rounded-full">
                            {{ torrent.category }}
                        </span>
                        <span class="language-flag text-xs">{{ torrent.language_flag }}</span>
                        <span class="text-gray-600 dark:text-gray-300 text-[10px] whitespace-nowrap">
                            {{ torrent.size }}
                        </span>
                    </div>
                </div>

                <!-- Boutons mobiles compacts -->
                <div class=" flex-col space-y-1 min-w-max-content">
                    <a href="{{ torrent.magnet }}"
                        class="magnet-btn  items-center justify-center px-2 py-1 rounded-lg font-medium bg-indigo-600 hover:bg-indigo-700 text-white text-[10px]">
                        <i class="fas fa-magnet mr-1 text-[10px]">  Magnet Link</i>
                    </a>
                    <a href="{{ torrent.link }}"
                        class="torrent-btn items-center justify-center px-2 py-1 rounded-lg font-medium bg-emerald-600 hover:bg-emerald-700 text-white text-[10px]">
                        <i class="fas fa-download text-medium">Telecharger</i>
                    </a>
                </div>
            </div>

            <!-- Ligne inférieure mobile -->
            <div class="mt-2   justify-between items-center text-[10px] gap-2">
                <div class="  gap-x-3 gap-y-1">
                    <div class=" items-center text-gray-900 dark:text-white">
                        <i class="fas fa-upload text-green-500 mr-0.5"></i>
                        <span>{{ torrent.seeders }}</span>
                    </div>
                    <div class=" items-center text-gray-900 dark:text-white">
                        <i class="fas fa-download text-yellow-500 mr-0.5"></i>
                        <span>{{ torrent.leechers }}</span>
                    </div>
                    <div class=" items-center text-gray-900 dark:text-white">
                        <i class="fas fa-check-circle text-blue-500 mr-0.5"></i>
                        <span>{{ torrent.completed }}</span>
                    </div>
                </div>

                <span class="text-gray-600 dark:text-gray-400 flex-shrink-0">
                    <i class="far fa-clock text-purple-500 mr-1"></i>
                    {{ torrent.pub_date }}
                </span>
            </div>
        </div>
    </div>
    {% endfor %}
    {% else %}
    <div class="text-center py-8 bg-white dark:bg-gray-700 rounded-xl">
        <i class="fas fa-cloud-download-alt text-3xl text-indigo-500 mb-3"></i>
        <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-1">Aucun résultat trouvé</h3>
        <p class="text-gray-600 dark:text-gray-400 text-sm">Essayez de modifier vos critères de recherche.</p>
    </div>
    {% endif %}
</div>

<!-- Pagination mobile compacte -->
{% if total_pages > 1 %}
{% set base_url = base_uri + "/search" %}
{% set query_params = {
    "query": query,
    "category": category,
    "subcategory": subcategory,
    "sort": sort,
    "filter": filter
} %}

<div class="pagination flex flex-wrap justify-center mt-6 gap-1">
    <a href="{{ base_url }}?{{ query_params|urlencode }}&page=1"
        class="page-btn w-8 h-8 flex items-center justify-center rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white hover:bg-indigo-600 hover:text-white text-xs {% if page == 1 %}opacity-50 cursor-not-allowed{% endif %}">
        <i class="fas fa-angle-double-left text-[10px]"></i>
    </a>

    <a href="{{ base_url }}?{{ query_params|urlencode }}&page={{ page-1 }}"
        class="page-btn w-8 h-8 flex items-center justify-center rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white hover:bg-indigo-600 hover:text-white text-xs {% if page == 1 %}opacity-50 cursor-not-allowed{% endif %}">
        <i class="fas fa-angle-left text-[10px]"></i>
    </a>

    {% for p in page_range %}
    <a href="{{ base_url }}?{{ query_params|urlencode }}&page={{ p }}"
        class="page-btn w-8 h-8 flex items-center justify-center rounded-lg text-xs {% if p == page %}bg-indigo-600 text-white{% else %}bg-white dark:bg-gray-700 text-gray-900 dark:text-white hover:bg-gray-200 dark:hover:bg-gray-600{% endif %}">
        {{ p }}
    </a>
    {% endfor %}

    <a href="{{ base_url }}?{{ query_params|urlencode }}&page={{ page+1 }}"
        class="page-btn w-8 h-8 flex items-center justify-center rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white hover:bg-indigo-600 hover:text-white text-xs {% if page == total_pages %}opacity-50 cursor-not-allowed{% endif %}">
        <i class="fas fa-angle-right text-[10px]"></i>
    </a>

    <a href="{{ base_url }}?{{ query_params|urlencode }}&page={{ total_pages }}"
        class="page-btn w-8 h-8 flex items-center justify-center rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white hover:bg-indigo-600 hover:text-white text-xs {% if page == total_pages %}opacity-50 cursor-not-allowed{% endif %}">
        <i class="fas fa-angle-double-right text-[10px]"></i>
    </a>
</div>
{% endif %}